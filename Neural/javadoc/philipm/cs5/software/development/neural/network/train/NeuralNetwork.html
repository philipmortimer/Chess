<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (1.8.0_221) on Fri Mar 12 18:47:54 GMT 2021 -->
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>NeuralNetwork (PhilipM CS5 Software Development Neural Network train)</title>
<meta name="date" content="2021-03-12">
<link rel="stylesheet" type="text/css" href="../../../../../../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../../../../../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="NeuralNetwork (PhilipM CS5 Software Development Neural Network train)";
        }
    }
    catch(err) {
    }
//-->
var methods = {"i0":9,"i1":9,"i2":10,"i3":10,"i4":10,"i5":9,"i6":9,"i7":9,"i8":9,"i9":10,"i10":10,"i11":9,"i12":10,"i13":9,"i14":9,"i15":9,"i16":10,"i17":10,"i18":10};
var tabs = {65535:["t0","All Methods"],1:["t1","Static Methods"],2:["t2","Instance Methods"],8:["t4","Concrete Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../../../philipm/cs5/software/development/neural/network/train/package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/NeuralNetwork.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../../../index-files/index-1.html">Index</a></li>
<li><a href="../../../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../../../philipm/cs5/software/development/neural/network/train/ChessNeuralNetwork.html" title="class in philipm.cs5.software.development.neural.network.train"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../../../../../philipm/cs5/software/development/neural/network/train/PhilipMCS5SoftwareDevelopmentNeuralNetworkTrain.html" title="class in philipm.cs5.software.development.neural.network.train"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../../../index.html?philipm/cs5/software/development/neural/network/train/NeuralNetwork.html" target="_top">Frames</a></li>
<li><a href="NeuralNetwork.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">philipm.cs5.software.development.neural.network.train</div>
<h2 title="Class NeuralNetwork" class="title">Class NeuralNetwork</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li>philipm.cs5.software.development.neural.network.train.NeuralNetwork</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<hr>
<br>
<pre>public class <span class="typeNameLabel">NeuralNetwork</span>
extends java.lang.Object</pre>
<div class="block">This class is used to train my chess neural network</div>
<dl>
<dt><span class="simpleTagLabel">Author:</span></dt>
<dd>mortimer</dd>
</dl>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- =========== FIELD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="field.summary">
<!--   -->
</a>
<h3>Field Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Field Summary table, listing fields, and an explanation">
<caption><span>Fields</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Field and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../../philipm/cs5/software/development/neural/network/train/NeuralNetwork.html#ACTIV_IN">ACTIV_IN</a></span></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../../philipm/cs5/software/development/neural/network/train/NeuralNetwork.html#ALL_LENGTH">ALL_LENGTH</a></span></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private double[]</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../../philipm/cs5/software/development/neural/network/train/NeuralNetwork.html#ALL_WEIGHTS_AND_BIASES">ALL_WEIGHTS_AND_BIASES</a></span></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private static java.lang.String</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../../philipm/cs5/software/development/neural/network/train/NeuralNetwork.html#BEST_NET_FILE_NAME">BEST_NET_FILE_NAME</a></span></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private int[]</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../../philipm/cs5/software/development/neural/network/train/NeuralNetwork.html#CURRENT_ALL">CURRENT_ALL</a></span></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private static java.lang.String</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../../philipm/cs5/software/development/neural/network/train/NeuralNetwork.html#FILE_NAME">FILE_NAME</a></span></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private int[]</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../../philipm/cs5/software/development/neural/network/train/NeuralNetwork.html#INDEX_CACHE">INDEX_CACHE</a></span></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private int[]</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../../philipm/cs5/software/development/neural/network/train/NeuralNetwork.html#INDEX_FOR_ACTIVS_ERROR">INDEX_FOR_ACTIVS_ERROR</a></span></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private int[]</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../../philipm/cs5/software/development/neural/network/train/NeuralNetwork.html#INDEX_FOR_ALL_WEIGHTS_ERROR">INDEX_FOR_ALL_WEIGHTS_ERROR</a></span></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../../philipm/cs5/software/development/neural/network/train/NeuralNetwork.html#LENGTH_OF_NEURONS_DROPPED_ARRAY">LENGTH_OF_NEURONS_DROPPED_ARRAY</a></span></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private int[]</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../../philipm/cs5/software/development/neural/network/train/NeuralNetwork.html#NET_STRUCTURE">NET_STRUCTURE</a></span></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../../philipm/cs5/software/development/neural/network/train/NeuralNetwork.html#NET_STRUCTURE_LENGTH">NET_STRUCTURE_LENGTH</a></span></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../../philipm/cs5/software/development/neural/network/train/NeuralNetwork.html#NET_STRUCTURE_LENGTH_MINUS_ONE">NET_STRUCTURE_LENGTH_MINUS_ONE</a></span></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private boolean[]</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../../philipm/cs5/software/development/neural/network/train/NeuralNetwork.html#NEURONS_DROPPED">NEURONS_DROPPED</a></span></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private double[]</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../../philipm/cs5/software/development/neural/network/train/NeuralNetwork.html#nodeValuePostActivation">nodeValuePostActivation</a></span></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private double[]</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../../philipm/cs5/software/development/neural/network/train/NeuralNetwork.html#nodeValuePreActivation">nodeValuePreActivation</a></span></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private double[]</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../../philipm/cs5/software/development/neural/network/train/NeuralNetwork.html#previousMHat">previousMHat</a></span></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private double[]</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../../philipm/cs5/software/development/neural/network/train/NeuralNetwork.html#previousVHat">previousVHat</a></span></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private java.util.Random</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../../philipm/cs5/software/development/neural/network/train/NeuralNetwork.html#RAND">RAND</a></span></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private double</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../../philipm/cs5/software/development/neural/network/train/NeuralNetwork.html#timeStep">timeStep</a></span></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private int[]</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../../philipm/cs5/software/development/neural/network/train/NeuralNetwork.html#TOT_NEURON">TOT_NEURON</a></span></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../../philipm/cs5/software/development/neural/network/train/NeuralNetwork.html#TOTAL_NEURONS">TOTAL_NEURONS</a></span></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../../philipm/cs5/software/development/neural/network/train/NeuralNetwork.html#TOTAL_NEURONS_MINUS_LAST_LAYER">TOTAL_NEURONS_MINUS_LAST_LAYER</a></span></code>&nbsp;</td>
</tr>
</table>
</li>
</ul>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><span class="memberNameLink"><a href="../../../../../../../philipm/cs5/software/development/neural/network/train/NeuralNetwork.html#NeuralNetwork-int:A-">NeuralNetwork</a></span>(int[]&nbsp;netStructure)</code>
<div class="block">Creates a neural network of the desired architecture using reLu in all layer bar the output layer, where the softmax function is used</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t1" class="tableTab"><span><a href="javascript:show(1);">Static Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">Instance Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t4" class="tableTab"><span><a href="javascript:show(8);">Concrete Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code>private static double</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../../philipm/cs5/software/development/neural/network/train/NeuralNetwork.html#activation-double-">activation</a></span>(double&nbsp;x)</code>
<div class="block">Uses the specified activation function.</div>
</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code>private static double</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../../philipm/cs5/software/development/neural/network/train/NeuralNetwork.html#activationDerivative-double-">activationDerivative</a></span>(double&nbsp;x)</code>
<div class="block">Returns the gradient of the chosen activation.</div>
</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code>private double[]</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../../philipm/cs5/software/development/neural/network/train/NeuralNetwork.html#calcGradientAttemptOptimised-double:A-">calcGradientAttemptOptimised</a></span>(double[]&nbsp;desiredOutput)</code>
<div class="block">This method calculates the gradient of each parameter with respect to the loss function.</div>
</td>
</tr>
<tr id="i3" class="rowColor">
<td class="colFirst"><code>double[]</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../../philipm/cs5/software/development/neural/network/train/NeuralNetwork.html#feedThroughNet-double:A-">feedThroughNet</a></span>(double[]&nbsp;input)</code>
<div class="block">This feeds a desired input through the neural network and returns the output.</div>
</td>
</tr>
<tr id="i4" class="altColor">
<td class="colFirst"><code>private double</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../../philipm/cs5/software/development/neural/network/train/NeuralNetwork.html#getRandDoubleBetweenOneAndMinusOne-int-int-">getRandDoubleBetweenOneAndMinusOne</a></span>(int&nbsp;numberOfNeuronsInLayerBelow,
                                  int&nbsp;numberOfNeuronsInLayer)</code>
<div class="block">Gets a random number between one and minus one using the xavier technique.</div>
</td>
</tr>
<tr id="i5" class="rowColor">
<td class="colFirst"><code>private static int[][]</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../../philipm/cs5/software/development/neural/network/train/NeuralNetwork.html#getTestData--">getTestData</a></span>()</code>
<div class="block">Gets the test data</div>
</td>
</tr>
<tr id="i6" class="altColor">
<td class="colFirst"><code>private static int[][]</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../../philipm/cs5/software/development/neural/network/train/NeuralNetwork.html#getTrainingData--">getTrainingData</a></span>()</code>
<div class="block">Gets the training data</div>
</td>
</tr>
<tr id="i7" class="rowColor">
<td class="colFirst"><code>private static double</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../../philipm/cs5/software/development/neural/network/train/NeuralNetwork.html#gradRELU-double-">gradRELU</a></span>(double&nbsp;x)</code>
<div class="block">This calculates the first oder derivative of reLu.</div>
</td>
</tr>
<tr id="i8" class="altColor">
<td class="colFirst"><code>private static double</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../../philipm/cs5/software/development/neural/network/train/NeuralNetwork.html#gradTanH-double-">gradTanH</a></span>(double&nbsp;x)</code>
<div class="block">This calculates the the first order derivative of tanH</div>
</td>
</tr>
<tr id="i9" class="rowColor">
<td class="colFirst"><code>double[]</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../../philipm/cs5/software/development/neural/network/train/NeuralNetwork.html#loadBestNetFile--">loadBestNetFile</a></span>()</code>
<div class="block">Loads the array stored in the best net text file, assuming it is intended for a network with the architecture of the current network.</div>
</td>
</tr>
<tr id="i10" class="altColor">
<td class="colFirst"><code>double[]</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../../philipm/cs5/software/development/neural/network/train/NeuralNetwork.html#loadBestNetWithThisArchitecture--">loadBestNetWithThisArchitecture</a></span>()</code>
<div class="block">Loads the best neural network with the architecture of the network that is stored in the network info text file</div>
</td>
</tr>
<tr id="i11" class="rowColor">
<td class="colFirst"><code>private static double</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../../philipm/cs5/software/development/neural/network/train/NeuralNetwork.html#reLU-double-">reLU</a></span>(double&nbsp;x)</code>
<div class="block">This function executes the reLu function</div>
</td>
</tr>
<tr id="i12" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../../philipm/cs5/software/development/neural/network/train/NeuralNetwork.html#setAllWeightsAndBiases-double:A-">setAllWeightsAndBiases</a></span>(double[]&nbsp;allWAndB)</code>
<div class="block">Sets all weights and biases in the network to the chosen value</div>
</td>
</tr>
<tr id="i13" class="rowColor">
<td class="colFirst"><code>private static void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../../philipm/cs5/software/development/neural/network/train/NeuralNetwork.html#shuffleTrainingDataArray-int:A:A-">shuffleTrainingDataArray</a></span>(int[][]&nbsp;array)</code>
<div class="block">Shuffles the training data array.</div>
</td>
</tr>
<tr id="i14" class="altColor">
<td class="colFirst"><code>private static double[]</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../../philipm/cs5/software/development/neural/network/train/NeuralNetwork.html#softmax-double:A-">softmax</a></span>(double[]&nbsp;input)</code>
<div class="block">Performs the softmax function on an input vector</div>
</td>
</tr>
<tr id="i15" class="rowColor">
<td class="colFirst"><code>private static double</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../../philipm/cs5/software/development/neural/network/train/NeuralNetwork.html#tanH-double-">tanH</a></span>(double&nbsp;x)</code>
<div class="block">This is the hyperbolic tangent function.</div>
</td>
</tr>
<tr id="i16" class="altColor">
<td class="colFirst"><code>double[]</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../../philipm/cs5/software/development/neural/network/train/NeuralNetwork.html#testAccuracy-int:A:A-">testAccuracy</a></span>(int[][]&nbsp;testData)</code>
<div class="block">Tests the network's accuracy</div>
</td>
</tr>
<tr id="i17" class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../../philipm/cs5/software/development/neural/network/train/NeuralNetwork.html#trainNew-double-int-int-int-int-double-">trainNew</a></span>(double&nbsp;LEARNING_RATE,
        int&nbsp;NO_OF_EPOCHS,
        int&nbsp;SAMPLE_SIZE,
        int&nbsp;TOTAL_TRAIN_SIZE,
        int&nbsp;PRINT_AND_TEST_AFTER_THIS_MANY_ITERATIONS,
        double&nbsp;DROPOUT_RATE)</code>
<div class="block">Trains the neural network on a dataset using backpropagation in conjuction with the ADAM optimiser.</div>
</td>
</tr>
<tr id="i18" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../../philipm/cs5/software/development/neural/network/train/NeuralNetwork.html#writeBestNetToBestFile--">writeBestNetToBestFile</a></span>()</code>
<div class="block">Gets the best network with this structure and loads it to a text file</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<code>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ FIELD DETAIL =========== -->
<ul class="blockList">
<li class="blockList"><a name="field.detail">
<!--   -->
</a>
<h3>Field Detail</h3>
<a name="NET_STRUCTURE_LENGTH">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>NET_STRUCTURE_LENGTH</h4>
<pre>private final&nbsp;int NET_STRUCTURE_LENGTH</pre>
</li>
</ul>
<a name="NET_STRUCTURE_LENGTH_MINUS_ONE">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>NET_STRUCTURE_LENGTH_MINUS_ONE</h4>
<pre>private final&nbsp;int NET_STRUCTURE_LENGTH_MINUS_ONE</pre>
</li>
</ul>
<a name="ALL_LENGTH">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>ALL_LENGTH</h4>
<pre>private final&nbsp;int ALL_LENGTH</pre>
</li>
</ul>
<a name="TOT_NEURON">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>TOT_NEURON</h4>
<pre>private final&nbsp;int[] TOT_NEURON</pre>
</li>
</ul>
<a name="CURRENT_ALL">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>CURRENT_ALL</h4>
<pre>private final&nbsp;int[] CURRENT_ALL</pre>
</li>
</ul>
<a name="RAND">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>RAND</h4>
<pre>private final&nbsp;java.util.Random RAND</pre>
</li>
</ul>
<a name="INDEX_FOR_ALL_WEIGHTS_ERROR">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>INDEX_FOR_ALL_WEIGHTS_ERROR</h4>
<pre>private final&nbsp;int[] INDEX_FOR_ALL_WEIGHTS_ERROR</pre>
</li>
</ul>
<a name="INDEX_FOR_ACTIVS_ERROR">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>INDEX_FOR_ACTIVS_ERROR</h4>
<pre>private final&nbsp;int[] INDEX_FOR_ACTIVS_ERROR</pre>
</li>
</ul>
<a name="ACTIV_IN">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>ACTIV_IN</h4>
<pre>private final&nbsp;int ACTIV_IN</pre>
</li>
</ul>
<a name="NET_STRUCTURE">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>NET_STRUCTURE</h4>
<pre>private final&nbsp;int[] NET_STRUCTURE</pre>
</li>
</ul>
<a name="ALL_WEIGHTS_AND_BIASES">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>ALL_WEIGHTS_AND_BIASES</h4>
<pre>private final&nbsp;double[] ALL_WEIGHTS_AND_BIASES</pre>
</li>
</ul>
<a name="TOTAL_NEURONS">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>TOTAL_NEURONS</h4>
<pre>private final&nbsp;int TOTAL_NEURONS</pre>
</li>
</ul>
<a name="TOTAL_NEURONS_MINUS_LAST_LAYER">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>TOTAL_NEURONS_MINUS_LAST_LAYER</h4>
<pre>private final&nbsp;int TOTAL_NEURONS_MINUS_LAST_LAYER</pre>
</li>
</ul>
<a name="nodeValuePreActivation">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>nodeValuePreActivation</h4>
<pre>private&nbsp;double[] nodeValuePreActivation</pre>
</li>
</ul>
<a name="nodeValuePostActivation">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>nodeValuePostActivation</h4>
<pre>private&nbsp;double[] nodeValuePostActivation</pre>
</li>
</ul>
<a name="FILE_NAME">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>FILE_NAME</h4>
<pre>private static final&nbsp;java.lang.String FILE_NAME</pre>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../../../../constant-values.html#philipm.cs5.software.development.neural.network.train.NeuralNetwork.FILE_NAME">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="timeStep">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>timeStep</h4>
<pre>private&nbsp;double timeStep</pre>
</li>
</ul>
<a name="previousMHat">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>previousMHat</h4>
<pre>private&nbsp;double[] previousMHat</pre>
</li>
</ul>
<a name="previousVHat">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>previousVHat</h4>
<pre>private&nbsp;double[] previousVHat</pre>
</li>
</ul>
<a name="BEST_NET_FILE_NAME">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>BEST_NET_FILE_NAME</h4>
<pre>private static final&nbsp;java.lang.String BEST_NET_FILE_NAME</pre>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../../../../constant-values.html#philipm.cs5.software.development.neural.network.train.NeuralNetwork.BEST_NET_FILE_NAME">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="NEURONS_DROPPED">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>NEURONS_DROPPED</h4>
<pre>private final&nbsp;boolean[] NEURONS_DROPPED</pre>
</li>
</ul>
<a name="LENGTH_OF_NEURONS_DROPPED_ARRAY">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>LENGTH_OF_NEURONS_DROPPED_ARRAY</h4>
<pre>private final&nbsp;int LENGTH_OF_NEURONS_DROPPED_ARRAY</pre>
</li>
</ul>
<a name="INDEX_CACHE">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>INDEX_CACHE</h4>
<pre>private final&nbsp;int[] INDEX_CACHE</pre>
</li>
</ul>
</li>
</ul>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="NeuralNetwork-int:A-">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>NeuralNetwork</h4>
<pre>public&nbsp;NeuralNetwork(int[]&nbsp;netStructure)</pre>
<div class="block">Creates a neural network of the desired architecture using reLu in all layer bar the output layer, where the softmax function is used</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>netStructure</code> - The network structure, with element 0 specifying the number of nodes in the input layer and the final element specifying the number of nodes in the output layer</dd>
</dl>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="loadBestNetWithThisArchitecture--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>loadBestNetWithThisArchitecture</h4>
<pre>public&nbsp;double[]&nbsp;loadBestNetWithThisArchitecture()</pre>
<div class="block">Loads the best neural network with the architecture of the network that is stored in the network info text file</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The weights and biases for the best network.</dd>
</dl>
</li>
</ul>
<a name="loadBestNetFile--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>loadBestNetFile</h4>
<pre>public&nbsp;double[]&nbsp;loadBestNetFile()
                         throws java.lang.Exception</pre>
<div class="block">Loads the array stored in the best net text file, assuming it is intended for a network with the architecture of the current network.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The weights and biases array</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.Exception</code> - An exception may occur if the best net file does not match the network structure.</dd>
</dl>
</li>
</ul>
<a name="tanH-double-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>tanH</h4>
<pre>private static&nbsp;double&nbsp;tanH(double&nbsp;x)</pre>
<div class="block">This is the hyperbolic tangent function.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>x</code> - The input</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the output of tanH</dd>
</dl>
</li>
</ul>
<a name="gradTanH-double-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>gradTanH</h4>
<pre>private static&nbsp;double&nbsp;gradTanH(double&nbsp;x)</pre>
<div class="block">This calculates the the first order derivative of tanH</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>x</code> - The input</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The output</dd>
</dl>
</li>
</ul>
<a name="reLU-double-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>reLU</h4>
<pre>private static&nbsp;double&nbsp;reLU(double&nbsp;x)</pre>
<div class="block">This function executes the reLu function</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>x</code> - The input</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The output</dd>
</dl>
</li>
</ul>
<a name="gradRELU-double-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>gradRELU</h4>
<pre>private static&nbsp;double&nbsp;gradRELU(double&nbsp;x)</pre>
<div class="block">This calculates the first oder derivative of reLu. Note ((dy/dx)reLU(0)) is handled as 0 (although reLU is not differentiable at x = 0)</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>x</code> - The input</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The output</dd>
</dl>
</li>
</ul>
<a name="softmax-double:A-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>softmax</h4>
<pre>private static&nbsp;double[]&nbsp;softmax(double[]&nbsp;input)</pre>
<div class="block">Performs the softmax function on an input vector</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>input</code> - The input vector</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The output vector</dd>
</dl>
</li>
</ul>
<a name="calcGradientAttemptOptimised-double:A-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>calcGradientAttemptOptimised</h4>
<pre>private&nbsp;double[]&nbsp;calcGradientAttemptOptimised(double[]&nbsp;desiredOutput)</pre>
<div class="block">This method calculates the gradient of each parameter with respect to the loss function. This is an optimised implementation of the backpropagation algorithm. This method assumes that the training item has already been fed through the network.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>desiredOutput</code> - The desired output of the neural network</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The gradient of each parameter's error with respect to the loss function.</dd>
</dl>
</li>
</ul>
<a name="shuffleTrainingDataArray-int:A:A-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>shuffleTrainingDataArray</h4>
<pre>private static&nbsp;void&nbsp;shuffleTrainingDataArray(int[][]&nbsp;array)</pre>
<div class="block">Shuffles the training data array.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>array</code> - The array to shuffle</dd>
</dl>
</li>
</ul>
<a name="trainNew-double-int-int-int-int-double-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>trainNew</h4>
<pre>public&nbsp;void&nbsp;trainNew(double&nbsp;LEARNING_RATE,
                     int&nbsp;NO_OF_EPOCHS,
                     int&nbsp;SAMPLE_SIZE,
                     int&nbsp;TOTAL_TRAIN_SIZE,
                     int&nbsp;PRINT_AND_TEST_AFTER_THIS_MANY_ITERATIONS,
                     double&nbsp;DROPOUT_RATE)</pre>
<div class="block">Trains the neural network on a dataset using backpropagation in conjuction with the ADAM optimiser.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>LEARNING_RATE</code> - The learning rate of the network - this is recommended to be 0.001 as the ADAM optimiser is used.</dd>
<dd><code>NO_OF_EPOCHS</code> - The number of epochs in the training cycle (each epoch is one complete pass of the dataset).</dd>
<dd><code>SAMPLE_SIZE</code> - The batch size - the number of training items used per network update.</dd>
<dd><code>TOTAL_TRAIN_SIZE</code> - The total size of the training data</dd>
<dd><code>PRINT_AND_TEST_AFTER_THIS_MANY_ITERATIONS</code> - How many iterations to test the accuracy and print it. Each iteration is one parameter update of the network.</dd>
<dd><code>DROPOUT_RATE</code> - The dropout rate of each neuron</dd>
</dl>
</li>
</ul>
<a name="getTrainingData--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getTrainingData</h4>
<pre>private static&nbsp;int[][]&nbsp;getTrainingData()</pre>
<div class="block">Gets the training data</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The training data</dd>
</dl>
</li>
</ul>
<a name="getTestData--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getTestData</h4>
<pre>private static&nbsp;int[][]&nbsp;getTestData()</pre>
<div class="block">Gets the test data</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The test data</dd>
</dl>
</li>
</ul>
<a name="testAccuracy-int:A:A-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>testAccuracy</h4>
<pre>public&nbsp;double[]&nbsp;testAccuracy(int[][]&nbsp;testData)</pre>
<div class="block">Tests the network's accuracy</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>testData</code> - The test data to use when testing accuracy</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The accuracy and loss of the system as an array of length 2. Element 0 corresponds to the accuracy, whilst element 1 is the loss.</dd>
</dl>
</li>
</ul>
<a name="feedThroughNet-double:A-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>feedThroughNet</h4>
<pre>public&nbsp;double[]&nbsp;feedThroughNet(double[]&nbsp;input)</pre>
<div class="block">This feeds a desired input through the neural network and returns the output. This is sometimes referred to as forward propagation.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>input</code> - The input array to the network</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The neural network output</dd>
</dl>
</li>
</ul>
<a name="setAllWeightsAndBiases-double:A-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setAllWeightsAndBiases</h4>
<pre>public&nbsp;void&nbsp;setAllWeightsAndBiases(double[]&nbsp;allWAndB)</pre>
<div class="block">Sets all weights and biases in the network to the chosen value</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>allWAndB</code> - The new set of weights and biases</dd>
</dl>
</li>
</ul>
<a name="activation-double-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>activation</h4>
<pre>private static&nbsp;double&nbsp;activation(double&nbsp;x)</pre>
<div class="block">Uses the specified activation function. Currently this is reLU.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>x</code> - The input</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The return</dd>
</dl>
</li>
</ul>
<a name="activationDerivative-double-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>activationDerivative</h4>
<pre>private static&nbsp;double&nbsp;activationDerivative(double&nbsp;x)</pre>
<div class="block">Returns the gradient of the chosen activation. Currently this returns the gradient for reLU.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>x</code> - The input</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The return value</dd>
</dl>
</li>
</ul>
<a name="getRandDoubleBetweenOneAndMinusOne-int-int-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getRandDoubleBetweenOneAndMinusOne</h4>
<pre>private&nbsp;double&nbsp;getRandDoubleBetweenOneAndMinusOne(int&nbsp;numberOfNeuronsInLayerBelow,
                                                  int&nbsp;numberOfNeuronsInLayer)</pre>
<div class="block">Gets a random number between one and minus one using the xavier technique.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>numberOfNeuronsInLayerBelow</code> - The number of neurons in the layer below</dd>
<dd><code>numberOfNeuronsInLayer</code> - The number of neurons in the current layer</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The random number</dd>
</dl>
</li>
</ul>
<a name="writeBestNetToBestFile--">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>writeBestNetToBestFile</h4>
<pre>public&nbsp;void&nbsp;writeBestNetToBestFile()</pre>
<div class="block">Gets the best network with this structure and loads it to a text file</div>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../../../philipm/cs5/software/development/neural/network/train/package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/NeuralNetwork.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../../../index-files/index-1.html">Index</a></li>
<li><a href="../../../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../../../philipm/cs5/software/development/neural/network/train/ChessNeuralNetwork.html" title="class in philipm.cs5.software.development.neural.network.train"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../../../../../philipm/cs5/software/development/neural/network/train/PhilipMCS5SoftwareDevelopmentNeuralNetworkTrain.html" title="class in philipm.cs5.software.development.neural.network.train"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../../../index.html?philipm/cs5/software/development/neural/network/train/NeuralNetwork.html" target="_top">Frames</a></li>
<li><a href="NeuralNetwork.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
